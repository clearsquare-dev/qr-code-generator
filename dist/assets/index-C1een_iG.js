(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function o(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(t){if(t.ep)return;t.ep=!0;const s=o(t);fetch(t.href,s)}})();var c=window.domo,u=["variablesDataset"];const n=document.getElementById("filterSelect"),f=document.getElementById("updateBtn"),l=document.getElementById("statusMessage");f.addEventListener("click",g);var p=["filter_label","variable_ids","variable_values"];async function m(){try{a("Loading filters...","info");var r=`/data/v1/${u[0]}?fields=${p.join()}`;const e=await c.get(r);if(!e||e.length===0){a("No filter options found in dataset","error");return}n.innerHTML="",e.forEach(o=>{const i=document.createElement("option");i.value=JSON.stringify({ids:o.variable_ids,values:o.variable_values}),i.textContent=o.filter_label,n.appendChild(i)}),n.options.length>0&&(n.selectedIndex=0),a("Filters loaded successfully","success")}catch(e){console.error("Error loading filter options:",e),a("Failed to load filters from dataset","error")}}function g(){if(n.options.length===0||!n.value){a("Please select a filter first","error");return}try{const r=JSON.parse(n.value),e=r.ids.split(",").map(s=>parseInt(s.trim())),o=r.values.split(",").map(s=>parseInt(s.trim()));if(e.length!==o.length){a("Error: Mismatch between variable IDs and values","error");return}const i=e.map((s,d)=>({functionId:s,value:o[d]}));v(i);const t=n.options[n.selectedIndex].text;a(`${t} updated successfully!`,"success")}catch(r){console.error("Error updating variables:",r),a("Failed to update variables","error")}}function a(r,e){l.textContent=r,l.className="",e==="error"?l.classList.add("text-red-600"):e==="success"?l.classList.add("text-green-600"):e==="info"&&l.classList.add("text-blue-600"),e==="success"&&setTimeout(()=>{l.textContent=""},3e3)}function v(r){const e=window.navigator.userAgent.toLowerCase(),o=/safari/.test(e),i=/iphone|ipod|ipad/.test(e),t=JSON.stringify({event:"variable",variables:r});i&&!o?window.webkit.messageHandlers.domofilter.postMessage(r):window.parent.postMessage(t,"*")}document.addEventListener("DOMContentLoaded",function(){m()});
